[
  {
    "id": "Ether",
    "name": "Ethernet II",
    "fields": [
      {
        "id": "dst",
        "name": "Destination",
        "type": "MACADDRESS"
      },
      {
        "id": "src",
        "name": "Source",
        "type": "MACADDRESS"
      },
      {
        "id": "type",
        "name": "Type",
        "type": "enum",
        "dict": {
          "IPv4" : 2048,
          "IPv6": 34525
        }
      }
    ],
    "payload": ["Dot1Q", "IP", "IPv6"]
  },
  {
    "id": "IP",
    "name": "Internet Protocol Version 4",
    "fields": [
      {
        "id": "version",
        "name": "Version",
        "type": "enum",
        "readonly": true,
        "dict": {
          "4": 4
        }
      },
      {
        "id": "ihl",
        "name": "Internet Header Length",
        "type": "NUMBER"
      },
      {
        "id": "tos",
        "name": "Differentiated Services Field",
        "type": "NUMBER"
      },
      {
        "id": "len",
        "name": "Total Length",
        "type": "NUMBER"
      },
      {
        "id": "id",
        "name": "Identification",
        "type": "NUMBER"
      },
      {
        "id": "flags",
        "name": "Flags",
        "type": "bitmask",
        "bits": [
          {"name": "Reserved", "mask": 4, "values":[{"name":"Not Set", "value": 0}, {"name":"Set", "value": 4}]},
          {"name": "Fragment", "mask": 2, "values":[{"name":"May fragment", "value": 0}, {"name":"Don't fragment", "value": 2}]},
          {"name": "More Fragments(MF)", "mask": 1, "values":[{"name":"Not Set", "value": 0}, {"name":"Set", "value": 1}]}
        ]
      },
      {
        "id": "frag",
        "name": "Fragment offset",
        "type": "NUMBER"
      },
      {
        "id": "ttl",
        "name": "TTL",
        "type": "NUMBER"
      },
      {
        "id": "proto",
        "name": "Protocol",
        "type": "enum",
        "dict": {
          "TCP": 6 ,
          "UDP": 17 
        }
      },
      {
        "id": "chksum",
        "name": "Checksum",
        "type": "STRING"
      },
      {
        "id": "src",
        "name": "Source address",
        "type": "IPv4Address"
      },
      {
        "id": "dst",
        "name": "Destination address",
        "type": "IPv4Address"
      },
      {
        "id": "options",
        "name": "Options",
        "type": "IPOptions"
      }
    ],
    "payload": ["TCP", "UDP"]
  },
  {
    "id": "TCP",
    "name": "TCP",
    "fields": [
      {
        "id": "sport",
        "name": "Source port",
        "type": "NUMBER"
      },
      {
        "id": "dport",
        "name": "Destination port",
        "type": "NUMBER"
      },
      {
        "id": "seq",
        "name": "Sequence number",
        "type": "NUMBER"
      },
      {
        "id": "ack",
        "name": "Acknowledgment number",
        "type": "NUMBER"
      },
      {
        "id": "dataofs",
        "name": "Data offset",
        "type": "NUMBER"
      },
      {
        "id": "reserved",
        "name": "Reserved",
        "type": "NUMBER"
      },
      {
        "id": "flags",
        "name": "Flags",
        "auto": false,
        "type": "bitmask",
        "bits": [
          {"name": "URG", "mask": 32, "values":[{"name":"Not Set", "value": 0}, {"name":"Set", "value": 32}]},
          {"name": "ACK", "mask": 16, "values":[{"name":"Not Set", "value": 0}, {"name":"Set", "value": 16}]},
          {"name": "PSH", "mask": 8, "values":[{"name":"Not Set", "value": 0}, {"name":"Set", "value": 8}]},
          {"name": "RST", "mask": 4, "values":[{"name":"Not Set", "value": 0}, {"name":"Set", "value": 4}]},
          {"name": "SYN", "mask": 2, "values":[{"name":"Not Set", "value": 0}, {"name":"Set", "value": 2}]},
          {"name": "FIN", "mask": 1, "values":[{"name":"Not Set", "value": 0}, {"name":"Set", "value": 1}]}
        ]
      },
      {
        "id": "window",
        "name": "Window size",
        "type": "NUMBER"
      },
      {
        "id": "chksum",
        "name": "Checksum",
        "auto": true,
        "type": "NUMBER"
      },
      {
        "id": "urgptr",
        "name": "Urgent pointer",
        "type": "NUMBER"
      },
      {
        "id": "options",
        "name": "Options",
        "type": "IPv4Options"
      }
    ],
    "payload": ["Raw"]
  },
  {
    "id": "Raw",
    "name": "Raw",
    "fields": [
      {
        "id": "load",
        "name": "Payload",
        "type": "STRING"
      }
    ],
    "payload": []
  }
]

